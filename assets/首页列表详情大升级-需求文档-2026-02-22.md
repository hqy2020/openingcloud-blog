# 首页/列表/详情页大升级需求文档（qzq.at 风格复刻 + 玻璃质感）

- 版本: v0.1
- 日期: 2026-02-22
- 覆盖范围: `/`、`/tech|/learning|/life`、`/posts/:slug`
- 关联文档:
  - 既有设计体系: `assets/博客需求文档.md`
  - 既有文案库: `assets/前端文字素材文档.md`
  - 既有 UX 全量验收: `reports/用户体验验收清单.md`

> 本文档用于“下一轮大升级”的需求落地与实现对齐。优先级最高的是 **封面页 Hero** 与其核心交互。

## 0. 背景与参考

- 参考站点: https://www.qzq.at
- 技术约束(强制): 以下每个技术至少在本次重构中 **可见且非摆设地** 使用一次:
  - MagicUI Dock: https://magicui.design/docs/components/dock
  - R3F(react-three-fiber): https://r3f.docs.pmnd.rs/getting-started/introduction
  - Motion.dev(motion): https://motion.dev/
  - Cult UI: https://www.cult-ui.com/
  - Aceternity UI: https://ui.aceternity.com/

## 1. 目标与非目标

### 1.1 目标

- 把首页升级成“强个人名片”封面页:
  - 固定文案结构 `My name is:` + 你的名字(间隔字母排版) + 角色与定位。
  - “太阳系公转”大 Logo: 像地球绕太阳一样持续旋转(公转+自转)，并具备 hover 微交互。
  - 明确展示“浙大”和“阿里云”徽章与统计信息(可配置)。
- 高光成就用“双向卡片跑马灯”表现(一行向左、一行向右，内容一致)。
- Web coding 项目区做到“像样例博客一样”:
  - 项目卡 hover 时，“指向”下方的技术栈标签(视觉上可感知的指示线/指针+高亮)。
- Time 模块复刻 qzq.at 的堆叠面积图体验:
  - x=Age(年龄轴)，y=%(占比)，hover 区域描边高亮。
  - 内容为你的人生阶段/类型占比(由 timeline 推导或静态配置)。
- 地图在“旅行足迹”基础上叠加“当前所在位置雷达闪现”效果。
- 两张雷达图:
  - 工作/文章相关(6 或 7 维)
  - 兴趣爱好相关(6 或 7 维)
- 文章详情页移动端改为 Tab 栏展示(文章/目录/信息)，桌面保持现有正文+侧栏目录。

### 1.2 非目标

- 不迁移框架(仍为 Vite + React SPA + React Router)。
- 不重做后端数据模型与同步/运维流程(可在 vNext 扩展可编辑字段，见 §7)。
- 不要求与 qzq.at 像素级复刻，但要求“结构、节奏、关键交互”高度对齐。

## 2. 实现落点(代码位置，供实现时对齐)

- 路由:
  - `frontend/src/app/router.tsx`
- 页面:
  - 首页: `frontend/src/pages/HomePage.tsx`
  - 列表: `frontend/src/pages/CategoryPage.tsx`
  - 详情: `frontend/src/pages/PostDetailPage.tsx`
- 现有可复用组件(本轮会强化/替换):
  - Dock: `frontend/src/components/ui/MagicUIDock.tsx` (MagicUI Dock 风格)
  - Marquee: `frontend/src/components/ui/Marquee.tsx`
  - R3F Hero 场景: `frontend/src/components/revamp/home/HeroR3FScene.tsx`
  - Aceternity 组件集: `frontend/src/components/ui/*` (beams/spotlight/3d/tracing 等)
  - Cult UI 形态: `frontend/src/components/ui/ToolbarExpandable.tsx` (Expandable toolbar)
- 数据与类型:
  - 首页聚合类型: `frontend/src/api/home.ts`
- SEO 预渲染:
  - `frontend/scripts/prerender-routes.mjs`

## 3. 全局视觉规范(Apple 透明质感)

### 3.1 Glassmorphism 基线

- 容器: `bg-white/60~90` + `backdrop-blur` + 细边框 `border-slate-200/60` + 柔和阴影。
- 分层: 背景(渐变/光斑/粒子) < 半透明卡片 < 文字内容 < 浮层(tooltip/dock)。
- 可读性: 正文字色优先 `slate-700~900`，背景特效不得压过文字对比度。

### 3.2 动效降级策略

- `prefers-reduced-motion: reduce`:
  - 禁用/显著减少: R3F 动画、长距离滚动视差、持续循环的大幅动效。
  - 保留: 基础淡入、布局切换(短时)。
- WebGL 不可用:
  - Hero 3D 必须 fallback 到静态轨道图/渐变/图片，不得白屏或报错。

## 4. 首页(`/`) 详细需求(分段落地)

> 优先级定义: P0=必须完成，P1=完成更好但可延后。

### S0. 封面 Hero(最重要) (P0)

#### S0-1 文案结构

- 固定结构(示意):
  - `My name is:` `<YourName>` (间隔字母)
  - `I'm a:` `<RoleLine>` (一句话身份/定位)
  - `<OneLiner>` (一句话世界观/方向)
- CTA:
  - 主 CTA: 进入文章列表(默认 `/tech`)
  - 次 CTA: 滚动到项目区(`#projects`) 或 Time 区(`#time`)

#### S0-2 太阳系公转大 Logo(R3F) 需求

- 表现(必须同时存在):
  - 中心“太阳”光晕(暖色 radial glow)。
  - 外圈轨道(可见线/粒子轨迹)。
  - “行星”= 你的 Logo 沿轨道 **公转**(持续)。
  - Logo 本体 **自转**(持续)。
- 交互:
  - hover: 光晕增强、速度略提升、或轻微 tilt(不要夸张)。
  - 移动端: 禁用 hover 交互，仅保留轻量动效或降级。
- 降级:
  - reduced-motion 或无 WebGL: 静态轨道 + CSS 轻浮动(可选)。

#### S0-3 徽章(浙大/阿里云)与统计

- 在 Hero 内提供两个“玻璃徽章卡”(icon + label + stats)。
- stats 字段可配置(见 §6 数据清单)。
- 图标来源:
  - 优先使用本地 `assets/` 或 `frontend/public/`。
  - 若无现成素材，则先用占位 SVG，后续替换。

#### 技术映射(必须)

- R3F: 太阳系公转 Logo(主)；或作为 Hero 背景 Canvas 的一部分。
- Motion: 文案入场(逐字/逐行)、CTA hover、徽章轻动效(低频)。
- Aceternity: 背景 beams/spotlight 作为氛围层(不抢文字)。

### S1. 高光成就双向跑马灯(P0)

- 两行横向滚动:
  - 第一行向左滚动
  - 第二行向右滚动
  - 内容集合相同，顺序可一致
- hover 任意卡片时:
  - 该行滚动暂停
  - 卡片聚光/抬升强调
- 数据来源:
  - 优先: 从 `highlights` 映射(阶段与条目合并成卡片)
  - 备选: 静态 `AchievementCard[]`
- 推荐实现:
  - 复用 `frontend/src/components/ui/Marquee.tsx`，做两行 + `reverse`。

### S2. Web Coding 项目区(P0)

#### S2-1 项目卡交互

- 卡片 hover 必须包含:
  - 玻璃卡抬升(translateY -2~-6)
  - 轻微 3D tilt 或 spotlight
  - 信息不被动效遮挡(标题/简介/链接清晰)

#### S2-2 “指向技术栈”效果(关键)

- 项目区底部固定一排“技术栈 chips”(React/TS/Three/ECharts/Django/... 可配置)。
- hover 某项目卡时:
  - 渲染一条从卡片到 chips 的“指示线/指针”(SVG path 或绝对定位线段均可)。
  - 同时高亮被指向的 chips(颜色/外发光/描边)。
- 离开 hover:
  - 指示线与高亮平滑退出(200~300ms)。

#### 技术映射(建议)

- Aceternity: `ThreeDCard` + `CardSpotlight` 叠加。
- Motion: 指示线/高亮过渡与布局动画。

### S3. Time: 人生阶段占比堆叠面积图(P0，复刻 qzq.at)

#### S3-1 图表形态(强制)

- 堆叠面积图(stacked area)。
- x 轴: Age(年龄，单位=年，可带刻度)。
- y 轴: Percent(0%~100%)。
- hover: 当前系列描边加粗高亮(类似 qzq.at 的 hover stroke)。

#### S3-2 数据生成规则(二选一，默认 A)

- A. 从 timeline 推导(默认):
  - 输入: `frontend/src/api/home.ts` 的 `timeline: TimelineNode[]`，使用 `type` 字段作为 series(建议 5 个: `learning|career|family|reflection|health`)。
  - 采样: 以“月”为粒度，从 `birth_date` 到 `today` 生成时间切片。
  - 对每个切片:
    - 找出该月“仍在进行”的 timeline 节点(满足 `start_date <= slice < end_date`，end_date 为空视为 today)。
    - 按 type 计数得 `count[type]`。
    - 若总和为 0: 归入 `reflection` 或 `life`(需要在实现时固定一个默认桶，避免空洞)。
    - 转换为百分比: `pct[type] = count[type] / sum(count) * 100`。
  - 输出: `[{ age, learning, career, family, reflection, health }]`。
- B. 静态配置:
  - 直接在 `TimeAreaSeriesConfig` 配置每个年龄段的占比曲线(用于更“叙事化”的图)。

#### S3-3 配置项(实现时暴露)

- `birth_date` (YYYY-MM-DD)
- series 列表与颜色映射
- 降级策略: mobile 或 reduced-motion 可降级为“横向占比条”(可选)

#### 技术映射

- 推荐用 D3 绘制(与参考一致的观感)；交互与过渡用 Motion。

### S4. 地图: 旅行足迹 + 当前雷达(P1)

- 旅行足迹保留现有涟漪点(visited cities)。
- 新增当前所在位置:
  - 更强的 ripple(更大半径/更高透明度/更快或更慢但明显的频率)
  - 额外“雷达扫光环”(可选)或双层 effectScatter
  - 显示当前城市文案
- 降级:
  - 地图加载失败时，展示旅行列表卡片(已有逻辑)，并额外在列表上标注“当前所在”。

### S5. 双雷达图(P1)

- 雷达 A: 工作/文章相关(6 或 7 维)
- 雷达 B: 兴趣爱好相关(6 或 7 维)
- 每张雷达图:
  - 玻璃卡容器
  - hover 提示维度值(tooltip)
  - 降级为表格(维度+数值)
- 技术建议:
  - 继续使用 ECharts(当前项目已用)绘制 radar。

### S6. Dock(P1)

- 桌面端常驻底部 Dock(可隐藏于移动端)。
- Dock item(至少 5 个):
  - GitHub、邮箱、后台、回到顶部
  - 快捷跳转: `#projects` `#time` `#map` 等
- 技术映射:
  - MagicUI Dock: 复用 `frontend/src/components/ui/MagicUIDock.tsx`。

## 5. 列表页(`/tech|/learning|/life`) 需求(P1)

- 分类 Tabs:
  - 切换分类时保留 query(例如 tag) 或行为明确。
  - Tabs 切换带方向感动效(已有 `DirectionAwareTabs` 可复用)。
- 筛选/排序:
  - `最新/热度(views)` 切换生效
  - Tag 过滤写入 URL，刷新可复原
- 工具条形态:
  - 使用 Cult UI 的 Expandable Toolbar 交互(可复用 `ToolbarExpandable`)。
- 列表交互:
  - hover 轻反馈
  - 自动加载更多不抖动、不重复、错误提示明确

## 6. 文章详情页(`/posts/:slug`) 移动端 Tabs(P1)

- 移动端显示 Tabs:
  - Tab1: 文章(正文)
  - Tab2: 目录
  - Tab3: 信息(标签/阅读时长/阅读量/更新时间)
- 桌面端:
  - 保持现有正文 + 右侧目录布局
  - Tabs 可隐藏或仅作为快捷入口(本轮默认仅移动端)

## 7. 接口/类型变更(写入实现说明，vNext 可选)

> 本次“落库 PRD”不要求立即修改后端，但为可维护性建议预留字段。

### 7.1 前端新增静态配置(建议目录，后续实现时再创建)

- `frontend/src/data/revamp/coverHero.ts`
  - `CoverHeroConfig`: `my_name_is`, `spaced_name`, `role_line`, `one_liner`, `cta`, `badges[]`
- `frontend/src/data/revamp/achievements.ts`
  - `AchievementCard[]`
- `frontend/src/data/revamp/featuredProjects.ts`
  - `FeaturedProject[]` + `tech_stack[]`
- `frontend/src/data/revamp/timeSeries.ts`
  - `TimeAreaSeriesConfig` + `birth_date`
- `frontend/src/data/revamp/location.ts`
  - `CurrentLocation`
- `frontend/src/data/revamp/radarMetrics.ts`
  - `RadarMetricSet`(two sets)

### 7.2 vNext 后端可选扩展(非阻断)

- `GET /api/home/` 增加:
  - `current_location`(city/lat/lng)
  - `radar_metrics`(A/B 两套)
  - `featured_projects`(tech stack 映射)

## 8. 数据清单(TODO: 你来填，缺一项就无法做成最终效果)

### 8.1 Hero 文案(TODO)

- `My name is:` 后的精确字符串(大小写/空格):
  - TODO
- `RoleLine`:
  - TODO
- `OneLiner`:
  - TODO

### 8.2 徽章统计(TODO)

- 浙大徽章:
  - icon: TODO(文件路径/来源)
  - stats: TODO(字段名与数值)
- 阿里云徽章:
  - icon: TODO(文件路径/来源)
  - stats: TODO(字段名与数值)

### 8.3 高光成就列表(TODO)

- 建议 8~16 张卡片:
  - TODO(标题/时间/描述/可选链接)

### 8.4 Featured Projects(TODO)

- 建议 6~12 个:
  - TODO(名称/简介/链接/tech_stack[])

### 8.5 Time 图表配置(TODO)

- `birth_date`: TODO(YYYY-MM-DD)
- series 选择(默认 timeline.type 五类):
  - TODO(若要自定义请给出映射表)

### 8.6 当前所在地(TODO)

- 城市名: TODO
- 经纬度(lat/lng): TODO

### 8.7 双雷达图(TODO)

- 雷达 A(工作/文章相关):
  - 维度(6/7): TODO
  - 数值(0-100): TODO
- 雷达 B(兴趣爱好相关):
  - 维度(6/7): TODO
  - 数值(0-100): TODO

