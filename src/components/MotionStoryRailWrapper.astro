---
/**
 * MotionStoryRail Astro wrapper â€” é¦–é¡µåŠ¨æ•ˆå™äº‹è½¨é“
 */
import { getCollection } from 'astro:content';
import { MotionStoryRail } from '@/react/sections/MotionStoryRail';

const collections = await Promise.all([
  getCollection('journal', ({ data }) => !data.draft),
  getCollection('tech', ({ data }) => !data.draft),
  getCollection('learning', ({ data }) => !data.draft),
  getCollection('life', ({ data }) => !data.draft),
]);

const posts = collections
  .flat()
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 12)
  .map((post) => ({
    title: post.data.title,
    description: post.data.description,
    date: post.data.date.toISOString(),
    category: post.data.category,
    cover: post.data.cover,
    slug: post.id,
  }));

const categories = [
  { key: 'journal', label: 'æ—¥è®°', icon: 'ğŸ““', desc: 'æ—¥è®° & è®¡åˆ’å¤ç›˜', count: collections[0].length },
  { key: 'tech', label: 'æŠ€æœ¯', icon: 'ğŸ’»', desc: 'Java Â· AI Â· Agent', count: collections[1].length },
  { key: 'learning', label: 'æ•ˆç‡', icon: 'ğŸ“š', desc: 'æ•ˆç‡æ–¹æ³• & è®¤çŸ¥', count: collections[2].length },
  { key: 'life', label: 'ç”Ÿæ´»', icon: 'ğŸ“·', desc: 'ç…§ç‰‡ & éšè®°', count: collections[3].length },
];
---

<MotionStoryRail client:visible posts={posts} categories={categories} />
