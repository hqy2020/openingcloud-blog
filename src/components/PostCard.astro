---
/**
 * 文章卡片组件
 * 展示文章摘要、日期、标签
 */
interface Props {
  title: string;
  description?: string;
  date: Date;
  category: string;
  tags?: string[];
  cover?: string;
  slug: string;
}

const { title, description, date, category, tags = [], cover, slug } = Astro.props;

const categoryLabels: Record<string, string> = {
  journal: '日记',
  tech: '技术',
  learning: '效率',
  life: '生活',
};

const categoryPillMap: Record<string, string> = {
  journal: 'bg-primary-50 text-primary-600 dark:bg-primary-900/25 dark:text-primary-200',
  tech: 'bg-sage-50 text-sage-700 dark:bg-sage-900/25 dark:text-sage-200',
  learning: 'bg-amber-50 text-amber-700 dark:bg-amber-900/25 dark:text-amber-200',
  life: 'bg-mauve-50 text-mauve-700 dark:bg-mauve-900/25 dark:text-mauve-200',
};

const formattedDate = new Date(date).toLocaleDateString('zh-CN', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<article class="group bg-white dark:bg-slate-800 rounded-xl shadow-soft hover:shadow-soft-md border border-slate-200 dark:border-slate-700 transition-all duration-300 overflow-hidden">
  {cover && (
    <a href={`/posts/${slug}/`} class="block overflow-hidden">
      <img
        src={cover}
        alt={title}
        class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
        loading="lazy"
      />
    </a>
  )}
  <div class="p-5">
    <!-- 分类标签 -->
    <div class="flex items-center gap-2 mb-3">
      <a
        href={`/${category}/`}
        class:list={[
          'text-xs font-medium px-2.5 py-1 rounded-full transition-colors',
          categoryPillMap[category] || categoryPillMap.journal,
        ]}
      >
        {categoryLabels[category] || category}
      </a>
      <time class="text-xs text-slate-400 dark:text-slate-500" datetime={date.toISOString()}>
        {formattedDate}
      </time>
    </div>

    <!-- 标题 -->
    <h2 class="text-lg font-semibold mb-2">
      <a
        href={`/posts/${slug}/`}
        class="text-slate-800 dark:text-slate-100 hover:text-primary-500 dark:hover:text-primary-400 transition-colors line-clamp-2"
      >
        {title}
      </a>
    </h2>

    <!-- 描述 -->
    {description && (
      <p class="text-sm text-slate-500 dark:text-slate-400 line-clamp-2 mb-3">
        {description}
      </p>
    )}

    <!-- 标签 -->
    {tags.length > 0 && (
      <div class="flex flex-wrap gap-1.5">
        {tags.slice(0, 3).map(tag => (
          <a
            href={`/tags/${tag}/`}
            class="text-xs px-2 py-0.5 rounded-md bg-slate-100 text-slate-500 dark:bg-slate-700 dark:text-slate-400 hover:bg-grass-50 hover:text-grass-600 dark:hover:bg-grass-700/20 dark:hover:text-grass-300 transition-colors"
          >
            #{tag}
          </a>
        ))}
      </div>
    )}
  </div>
</article>
