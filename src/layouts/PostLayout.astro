---
/**
 * æ–‡ç« è¯¦æƒ…å¸ƒå±€
 */
import Head from './Head.astro';
import Navbar from '@/components/Navbar.astro';
import Footer from '@/components/Footer.astro';

interface Props {
  title: string;
  description?: string;
  date: Date;
  category: string;
  tags?: string[];
  cover?: string;
}

const { title, description, date, category, tags = [], cover } = Astro.props;

const categoryLabels: Record<string, string> = {
  journal: 'ğŸ““ æ—¥è®°',
  tech: 'ğŸ’» æŠ€æœ¯',
  learning: 'ğŸ“š å­¦ä¹ ',
  life: 'ğŸ“· ç”Ÿæ´»',
};

const formattedDate = new Date(date).toLocaleDateString('zh-CN', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<Head title={title} description={description} image={cover}>
  <Navbar />
  <main class="flex-1 max-w-3xl mx-auto px-4 py-8 w-full">
    <article>
      <!-- æ–‡ç« å¤´éƒ¨ -->
      <header class="mb-8">
        {cover && (
          <img
            src={cover}
            alt={title}
            class="w-full h-64 md:h-80 object-cover rounded-xl mb-6"
          />
        )}
        <div class="flex items-center gap-3 mb-4">
          <a
            href={`/${category}/`}
            class="text-sm font-medium px-3 py-1 rounded-full bg-grass-50 text-grass-600 dark:bg-grass-700/20 dark:text-grass-300"
          >
            {categoryLabels[category] || category}
          </a>
          <time class="text-sm text-slate-400" datetime={date.toISOString()}>
            {formattedDate}
          </time>
        </div>
        <h1 class="text-3xl md:text-4xl font-bold text-slate-900 dark:text-slate-50 leading-tight">
          {title}
        </h1>
        {description && (
          <p class="mt-3 text-lg text-slate-500 dark:text-slate-400">{description}</p>
        )}
      </header>

      <!-- æ–‡ç« æ­£æ–‡ -->
      <div class="prose prose-slate dark:prose-invert max-w-none
        prose-headings:scroll-mt-20
        prose-a:text-primary-500 prose-a:no-underline hover:prose-a:underline
        prose-img:rounded-xl prose-img:shadow-md
        prose-pre:bg-slate-900 prose-pre:text-slate-100
        prose-code:before:content-none prose-code:after:content-none">
        <slot />
      </div>

      <!-- æ ‡ç­¾ -->
      {tags.length > 0 && (
        <div class="mt-8 pt-6 border-t border-slate-200 dark:border-slate-700">
          <div class="flex flex-wrap gap-2">
            {tags.map(tag => (
              <a
                href={`/tags/${tag}/`}
                class="text-sm px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-grass-50 hover:text-grass-600 dark:hover:bg-grass-700/20 dark:hover:text-grass-300 transition-colors"
              >
                #{tag}
              </a>
            ))}
          </div>
        </div>
      )}

      <!-- è¿”å› -->
      <div class="mt-8">
        <a
          href={`/${category}/`}
          class="inline-flex items-center gap-1 text-sm text-primary-500 hover:text-primary-600 transition-colors"
        >
          â† è¿”å›{categoryLabels[category]?.slice(2) || 'åˆ—è¡¨'}
        </a>
      </div>
    </article>
  </main>
  <Footer />
</Head>
